(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["order_packages/detail/index"],{"149d":function(o,e,t){"use strict";t.r(e);var n=t("35c1"),r=t.n(n);for(var i in n)["default"].indexOf(i)<0&&function(o){t.d(e,o,(function(){return n[o]}))}(i);e["default"]=r.a},"2caa":function(o,e,t){"use strict";t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return i})),t.d(e,"a",(function(){return n}));var n={uPopup:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-popup/u-popup")]).then(t.bind(null,"2d96"))},uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"8297"))},uCheckboxGroup:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(t.bind(null,"027f"))},uCheckbox:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-checkbox/u-checkbox")]).then(t.bind(null,"aa3f"))},uEmpty:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-empty/u-empty")]).then(t.bind(null,"086b"))}},r=function(){var o=this,e=o.$createElement,t=(o._self._c,o.discountList.length),n=!o.discountList||0===o.discountList.length,r=!o.discountList||0===o.discountList.length,i=o.__map(o.discountList,(function(e,t){var n=o.__get_orig(e),r="a"===e.discount_type?e.top_price.replace(".00",""):null,i="a"===e.discount_type?e.data.replace(".00",""):null;return{$orig:n,g3:r,g4:i}}));o._isMounted||(o.e0=function(e){o.discountShow=!0},o.e1=function(e){o.payShow=!1},o.e2=function(e){o.payShow=!1},o.e3=function(e){o.discountShow=!1}),o.$mp.data=Object.assign({},{$root:{g0:t,g1:n,g2:r,l0:i}})},i=[]},"35c1":function(o,e,t){"use strict";(function(o){var n=t("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(t("7ca3"));function i(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),t.push.apply(t,n)}return t}function u(o){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?i(Object(t),!0).forEach((function(e){(0,r.default)(o,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(t,e))}))}return o}var s={data:function(){return{payShow:!1,payType:1,orderInfo:{},userMoney:0,payFlag:!0,time_status:"a",pay_status:"a",statusBarHeight:"20",discountList:[],discountShow:!1,checkValue:[],shopInfo:{},coupon_obj:{},moneyObj:{}}},onLoad:function(e){var t=this;this.time_status=e.time_status,this.pay_status=e.pay_status,this.$request("/food/Order/userGetOrderDetail",{order_id:e.id}).then((function(o){t.orderInfo=o,t.selectCount()}));var n=this;o.getSystemInfo({success:function(o){n.statusBarHeight=o.statusBarHeight||20}})},methods:{changePayData:function(){var o=this,e=[];this.orderInfo.goods_list.length&&(e=this.orderInfo.goods_list.map((function(o){return(0,r.default)({goods_type:"Y"===o.is_group?"b":"a",goods_id:o.goods_id,number:o.number,choice_des:o.choice_des},o.group_goods?"group_goods":"",o.group_goods)}))),this.$request("/food/Order/computePayData",{goods_list:e,coupon_id:this.coupon_obj.id,pay_type:1===this.checkValue[0]?"b":"a"}).then((function(e){o.moneyObj=e}))},useCouponEven:function(o){this.coupon_obj=o,this.discountShow=!1,this.changePayData()},getCoupon:function(o){var e=this;this.$request("/food/Coupon/hasCoupon",{coupon_id:o.id}).then((function(){e.selectCount()}))},selectCount:function(){var e=this;if(!o.getStorageSync("token"))return!1;console.log("订单详情",this.orderInfo);var t=[];this.orderInfo.goods_list.length&&(t=this.orderInfo.goods_list.map((function(o){return(0,r.default)({goods_type:"Y"===o.is_group?"b":"a",goods_id:o.goods_id,number:o.number,choice_des:o.choice_des},o.group_goods?"group_goods":"",o.group_goods)}))),this.$request("/food/Coupon/getOrderCoupon",{store_id:this.orderInfo.store_id,goods_list:t}).then((function(o){e.discountList=o.list}))},goBack:function(){o.switchTab({url:"/pages/Order/index"})},changePayType:function(o){this.payType=o},addMenu:function(){if(!this.orderInfo.store_id)return o.showToast({title:"请等待数据加载后重试",icon:"none",duration:2e3}),!1;this.$nav("/home_packages/shop_detail/index",{id:this.orderInfo.store_id,type:"add",orderId:this.orderInfo.id,canwei:this.orderInfo.table_code})},goPay:function(){var o=this;this.$request("/food/User/getUserInfo").then((function(e){o.userMoney=e.money})),this.payShow=!0},confirm:function(){var e=this;if(this.payFlag){this.payFlag=!1;var t="";1===this.payType?t=1===this.checkValue[0]?"d":"c":2===this.payType&&(t=1===this.checkValue[0]?"b":"a"),this.$request("/food/Order/payOrder",{order_id:this.orderInfo.id,coupon_id:this.coupon_obj.id,pay_type:t}).then((function(t){1===t.result?(o.showToast({title:"支付成功",icon:"success",duration:2e3}),e.payShow=!1,e.$request("/food/Order/userGetOrderDetail",{order_id:e.orderInfo.id}).then((function(o){e.orderInfo=o})),e.payFlag=!0):3===t.result?o.requestPayment(u(u({provider:"wxpay"},t.pay_data),{},{success:function(o){e.payShow=!1,e.$request("/food/Order/userGetOrderDetail",{order_id:e.orderInfo.id}).then((function(o){e.orderInfo=o})),e.payFlag=!0},fail:function(){o.showToast({title:"用户取消支付",icon:"error"}),e.payFlag=!0}})):e.payFlag=!0})).catch((function(){e.payFlag=!0}))}}}};e.default=s}).call(this,t("df3c")["default"])},3922:function(o,e,t){},"6d2e":function(o,e,t){"use strict";t.r(e);var n=t("2caa"),r=t("149d");for(var i in r)["default"].indexOf(i)<0&&function(o){t.d(e,o,(function(){return r[o]}))}(i);t("aaee");var u=t("828b"),s=Object(u["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=s.exports},aaee:function(o,e,t){"use strict";var n=t("3922"),r=t.n(n);r.a},d0fd:function(o,e,t){"use strict";(function(o,e){var n=t("47a9");t("bcba");n(t("3240"));var r=n(t("6d2e"));o.__webpack_require_UNI_MP_PLUGIN__=t,e(r.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])}},[["d0fd","common/runtime","common/vendor"]]]);